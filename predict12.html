<html>
<body>
<div style="visibility:hidden">
<%

library("neuralnet")
library(rjson)

#Set working directory for the training data
#setwd("C:/OpenServer/domains/localhost/")
#getwd()

#Читаем данные для обучения нейросети
mydata<- read.csv(file="C:/Android/project/neural1/data.csv", header=TRUE, sep=";")
#mydata<- read.csv(file="data.csv", header=TRUE, sep=";")
mydata
attach(mydata)
names(mydata)
#print (mydata)

#Загружаем прогнозируемые аргументы
predict<- read.csv(file="C:/Android/project/neural1/predict.csv", header=FALSE, sep=";")
#predict<- read.csv(file="predict.csv", header=FALSE, sep=";")
predict
attach(predict)
names(predict)
#print (predict)

#Считаем количество прогнозируемых аргументов
count<- nrow(predict)
#print (count)

#Обучаем нейросеть
#Нейросеть имеет 10 слоёв
#Threshold is a numeric value specifying the threshold for the partial
#derivatives of the error function as stopping criteria.
net.sqr <- neuralnet(OUTPUT~X1+X2+X3+X4+Y1+Y2+Y3+Y4+Z1+Z2+Z3+D1,mydata, hidden=10, threshold=0.01)
#net.sqr <- neuralnet(output ~ input, data.norm, hidden=10, threshold=0.01)

#print(net.sqr)
 
#Рисуем нейросеть
#plot(net.sqr)
 
#Прогнозирование
testdata <- as.data.frame(predict) #Заносим прогнозируемые аргументы в переменную
net.results <- compute(net.sqr, testdata) #Вычисляем значения функции на основании прогнозируемых переменных
 
#Lets see what properties net.sqr has
#ls(net.results)
 
#Lets see the results
#print(net.results$net.result)
 
#Lets display a better version of the results
cleanoutput <- cbind(testdata,testdata,
                         as.data.frame(net.results$net.result))
colnames(cleanoutput) <- c("Input","Expected Output","Neural Net Output")
#print(cleanoutput)

</div>
<div>
<%
cat(toJSON(net.results$net.result))
%>
</div>
</body>
</html>